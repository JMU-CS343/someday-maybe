/* =======================================================================
   Someday Maybe — Global Styles
   Clean, commented, and de-duped.
   Breakpoints (mirror JS):
     ≤844px   : Drawer (hamburger)
     845–1189 : Icon rail (64px) with hover peek & optional pin
     ≥1190px  : Full sidebar (expanded) with optional desktop collapse
   ======================================================================= */

/* ===========================
   Design Tokens / Variables
   =========================== */
   :root {
    /* color scheme */
    --bg: #dad7c4;
    --panel: #e8e8df;
    --menu-card: #453b2a;
    --menu-text: #ffff;
    --text: #453b2a;
    --muted: #96948c;
    --pill: #c85e21;
    --accent: #5865f2;
    --card: #ffffff;
  
    /* effects & radii */
    --shadow: 0 1px 2px rgba(0,0,0,.08), 0 8px 24px rgba(0,0,0,.06);
    --radius: 16px;
  
    /* layout */
    --appbar-h: 70px;
  
    /* sidebar widths */
    --sidebar-w-expanded: 220px;   /* full */
    --sidebar-w-collapsed: 64px;   /* icon rail */
    --sidebar-w: var(--sidebar-w-expanded); /* current width used by layout */
  
    /* boards gutter for SWIPE layout (equal L/R buffer) */
    --boards-gutter: 24px;
  }
  
  body.theme-purple {
    --bg: #b3a2b6;
    --panel: #e2dbe5;
    --menu-card: #300234;
    --menu-text: #ffff;
    --text: #390c49;
    --muted: #938c96;
    --pill: #472b54;
    --accent: #a708eb;
    --card: #ffffff;
    --mini-bg: #f6f0f9;

  }
  
  /* ===========================
     Base / Reset
     =========================== */
  * { box-sizing: border-box; }
  
  body {
    margin: 0;
    font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    color: var(--text);
    background: var(--bg);
  }
  
  /* ===========================
     Top App Bar
     =========================== */
  .top-bar {
    position: sticky; top: 0; z-index: 10;
    display: flex; align-items: center; gap: 10px; justify-content: space-between;
    padding: 14px 20px;
    background: var(--bg);
    border-bottom: 1px solid #e6e7eb;
    min-height: var(--appbar-h);
  }
  
  .top-bar h1 { font-size: 20px; margin: 0; flex: 1; }
  
  /* Header hamburger (only visible at ≤844px) */
  .nav-toggle {
    display: none;
    place-items: center;
    width: 36px; height: 36px;
    border-radius: 10px;
    border: 1px solid #d4d7de;
    background: var(--panel);
    box-shadow: var(--shadow);
    font-size: 18px; cursor: pointer;
  }
  .nav-toggle i { color: var(--pill) !important; }
  
  .menu, .gear {
    width: 2.5rem; height: 2.5rem;
    border-radius: 1rem;
    background: var(--panel);
    display: grid; place-items: center;
    cursor: pointer; box-shadow: var(--shadow); border: none;
  }
  .gear i { color: var(--pill) !important; }
  
  /* Settings popover (JS-toggled) */
  .settings {
    position: absolute; right: 16px; top: 64px;
    width: 220px; background: var(--menu-card); color: var(--menu-text);
    border-radius: 12px; box-shadow: var(--shadow); padding: 10px; display: none;
  }
  .settings .btn {
    width: 100%; padding: 10px 12px; border: 1px solid #e6e7eb; background: #fff;
    border-radius: 10px; cursor: pointer; font: inherit; color: var(--text);
  }
  .settings .btn + .btn { margin-top: 8px; }
  
  /* ===========================
     App Shell: Sidebar + Content
     =========================== */
  .shell { min-height: calc(100dvh - var(--appbar-h)); }
  
  .sidebar {
    width: var(--sidebar-w);
    position: fixed; left: 0; top: var(--appbar-h); bottom: 0;
    display: flex; flex-direction: column;
    padding: 12px;
    background: var(--pill); color: #e7e7ea;
    border-right: 1px solid rgba(255,255,255,0.08);
    overflow: auto; z-index: 70;
    will-change: transform; contain: paint; /* smooth GPU slide on small screens */
  }
  
  .content { margin-left: var(--sidebar-w); }
  
  /* Sidebar nav items */
  .nav { list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 6px; }
  .nav-item {
    display: flex; align-items: center; gap: 10px;
    width: 100%; padding: 10px 12px; background: transparent;
    border: 0; border-radius: 8px; color: inherit; cursor: pointer; font: inherit;
  }
  .nav-item:hover { background: rgba(255,255,255,0.06); }
  .nav-item.is-active { background: rgba(88,101,242,0.18); outline: 1px solid rgba(88,101,242,0.5); }
  .icon { width: 22px; display: inline-grid; place-items: center; font-size: 18px; }
  .label { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  
  /* Bottom chevron */
  .collapse-btn {
    margin-top: auto; align-self: flex-end;
    padding: 8px 10px; border-radius: 8px; background: transparent; color: #e7e7ea;
    border: 1px solid rgba(255,255,255,0.15); cursor: pointer;
  }
  
  /* Desktop collapse state (≥1190px only; JS toggles the class) */
  body.sidebar-collapsed { --sidebar-w: var(--sidebar-w-collapsed); }
  body.sidebar-collapsed .label { display: none; }
  body.sidebar-collapsed .collapse-btn { transform: rotate(180deg); }
  
  /* Drawer backdrop element (only enabled at ≤844px) */
  .backdrop {
    position: fixed; inset: 0; z-index: 60; background: rgba(0,0,0,0.35);
    opacity: 0; pointer-events: none; transition: opacity .2s ease;
  }
  body.sidebar-open .backdrop { opacity: 1; pointer-events: auto; }
  
  /* ===========================
     Boards — SWIPE base (equal gutters)
     =========================== */
  .boards {
    padding: 24px var(--boards-gutter); /* equal left/right visual gutter */
    display: flex; flex-wrap: nowrap; gap: 24px; align-items: start;
    overflow-x: auto; overflow-y: hidden;
    height: calc(100dvh - var(--appbar-h));
    scroll-snap-type: x proximity;
  
    /* Make snap "start" land at the gutter, not the screen edge */
    scroll-padding-left: var(--boards-gutter);
    scroll-padding-right: var(--boards-gutter);
  }
  .boards::-webkit-scrollbar { height: 10px; }
  .boards::-webkit-scrollbar-thumb { background: #cfd3da; border-radius: 999px; }
  
  /* List column */
  .list {
    display: flex; flex-direction: column; align-items: center;
    background: var(--panel); border-radius: var(--radius); box-shadow: var(--shadow);
    min-height: 560px; max-height: 100%;
    width: 360px; flex: 0 0 360px; min-width: 0; scroll-snap-align: start;
  }
  .list-header {
    display: flex; align-items: center; justify-content: space-between;
    padding: 16px 16px 8px; width: 100%;
  }
  .list-title { font-size: 24px; font-weight: 700; }
  .list-menu { border: none; background: rgba(255,255,255,.55); }
  
  /* Tasks & Cards */
  .tasks { width: 100%; }
  .card {
    background: var(--mini-bg); margin: 12px 16px; border-radius: 14px; padding: 12px;
    position: relative; box-shadow: inset 0 0 0 1px rgba(0,0,0,.04);
  }
  .chip {
    display: inline-flex; align-items: center; justify-content: center;
    background: var(--pill); color: #fff; font-weight: 700; height: 24px;
    padding: 0 12px; border-radius: 999px; font-size: 12px; letter-spacing: .02em;
  }
  .task-title { margin: 10px 0 6px; font-weight: 600; }
  .muted { font-size: 12px; color: var(--muted); }
  
/* Checkbox */
.checkbox {
  position: absolute; right: 12px; top: 12px; width: 28px; height: 28px;
  border-radius: 999px; border: 2px solid var(--muted); background: #fff;
  display: grid; place-items: center; cursor: pointer;
}

  /* Make the input cover the whole circle so it receives the click */
  .checkbox input {
    position: absolute;
    inset: 0;          /* top/right/bottom/left: 0 */
    opacity: 0;        /* invisible but clickable */
    cursor: pointer;
    appearance: none;
  }

  /* Don’t let the SVG steal clicks */
  .checkbox svg { pointer-events: none; }

  /* Use aria-checked for styling since your JS updates it */
  .checkbox[aria-checked="true"]  { background: var(--pill); border-color: var(--pill); }
  .checkbox[aria-checked="true"] svg { display: block; fill: #fff; }
  .checkbox svg { display: none; width: 16px; height: 16px; }

  
  /* Adders */
  .add-task, .add-list {
    display: grid; place-items: center;
    width: 4rem; height: 4rem; margin: 0.5rem;
    border: 2px dashed var(--muted); border-radius: 1rem; cursor: pointer;
    color: var(--muted); font-weight: 600; background: rgba(255,255,255,.55);
  }
  
  /* Completed preview */
  .done-row { display: flex; align-items: center; gap: 12px; padding: 12px 16px; color: var(--muted); }
  .dot { width: 28px; height: 28px; border-radius: 999px; background: #201f2b; display: inline-block; }
  
  /* Pager (centered in content area) */
  .pager {
    position: fixed; bottom: 18px; left: var(--sidebar-w);
    width: calc(100vw - var(--sidebar-w));
    display: flex; justify-content: center; gap: 18px; pointer-events: none;
  }
  .pager button {
    pointer-events: auto; width: 54px; height: 40px;
    border-radius: 12px; border: 1px solid #d4d7de; background: #fff;
    box-shadow: var(--shadow); cursor: pointer;
  }
  
  /* Menu popover for list ⋯ */
  .menu-pop {
    position: absolute; z-index: 1000; min-width: 180px;
    background: var(--card); border: 1px solid #e6e7eb;
    border-radius: 10px; box-shadow: var(--shadow); padding: 6px;
  }
  .menu-pop button {
    display: block; width: 100%; text-align: left; padding: 10px 12px;
    background: #fff; border: none; border-radius: 8px; cursor: pointer; font: inherit; color: var(--text);
  }
  .menu-pop button:hover { background: #f5f6f8; }
  .menu-pop .danger { color: #b42318; }
  
  /* ===========================
     Calendar View
     =========================== */
  #calendar-view { padding: 24px; }
  .cal-head { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; }
  .cal-head h2 { margin: 0; font-size: 18px; }
  .cal-head .btn { padding: 8px 10px; border: 1px solid #e6e7eb; background: #fff; border-radius: 10px; cursor: pointer; }
  .cal-dow { display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; color: var(--muted); text-align: center; font-size: 12px; margin-bottom: 6px; }
  .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; }
  .cal-cell { background: #fff; border: 1px solid #e6e7eb; border-radius: 10px; padding: 8px; min-height: 92px; }
  .cal-date { font-weight: 700; margin-bottom: 4px; }
  .cal-item { font-size: 12px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  
  /* Drag & drop affordance */
  .card.drag-over, .tasks.drag-over, .cal-cell.drag-over { outline: 2px dashed var(--accent); }
  
  /* ===========================
     Layout Toggle (mounted in header next to gear)
     =========================== */
  .top-bar #layoutToggle { margin-right: 8px; }
  .top-bar #layoutToggle .segmented {
    display: inline-flex; gap: 0;
    background: #f4f5f7; border: 1px solid #d4d7de;
    border-radius: 12px; padding: 4px; box-shadow: var(--shadow);
  }
  .top-bar #layoutToggle .seg-btn {
    border: 0; background: transparent; padding: 6px 10px; border-radius: 8px;
    cursor: pointer; display: inline-grid; place-items: center;
  }
  .top-bar #layoutToggle .seg-btn svg { fill: var(--muted); }
  .top-bar #layoutToggle .seg-btn.is-active { background: #fff; }
  .top-bar #layoutToggle .seg-btn.is-active svg { fill: var(--text); }
  .top-bar #layoutToggle .seg-btn:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }
  
  /* ===========================
     Grid Mode (Boards)
     =========================== */
  .boards.is-grid {
    display: grid;
    /* default wide = 3 columns (also used in rail range) */
    grid-template-columns: repeat(3, minmax(320px, 1fr));
    gap: 24px; align-items: start; overflow: visible; height: auto; padding: 24px;
  }
  .boards.is-grid .list { width: auto; min-width: 0; flex: 0 0 auto; scroll-snap-align: none; }
  .boards.is-grid ~ .pager { display: none; } /* hide pager in grid */
  
  /* 2 columns in drawer */
  @media (max-width: 844px) {
    .boards.is-grid { grid-template-columns: repeat(2, minmax(280px, 1fr)); }
  }
  /* 1 column at very small widths */
  @media (max-width: 630px) {
    .boards.is-grid { grid-template-columns: 1fr; }
  }
  
  /* ===========================
     Swipe Mode (Boards)
     3 → 2 → 1 visible columns by flex-basis, matching grid breakpoints
     =========================== */
  .boards:not(.is-grid) .list {            /* Default/rail/desktop: 3 cards */
    width: auto; min-width: 0;
    flex: 0 0 calc((100% - 48px) / 3);     /* gap=24px → 2 gaps = 48px */
    scroll-snap-align: start;
  }
  @media (max-width: 844px) {              /* Drawer: 2 cards */
    .boards:not(.is-grid) .list { flex: 0 0 calc((100% - 24px) / 2); }
  }
  @media (max-width: 630px) {              /* Very small: 1 card */
    .boards:not(.is-grid) .list { flex: 0 0 100%; }
  }
  /* Safety: never squish cards below this width; lane will scroll instead */
  .boards .list { min-width: 280px; }
  
  /* ===========================
     Sidebar Modes
     =========================== */
  
  /* ≥1190px: Full sidebar (can collapse via body.sidebar-collapsed) */
  @media (min-width: 1190px) {
    :root { --sidebar-w: var(--sidebar-w-expanded); }
    .nav-toggle { display: none; }        /* hamburger hidden */
    #navBackdrop { display: none !important; }
  }
  
  /* 845–1189px: Icon rail (64px) + hover peek; can pin via JS class */
  @media (max-width: 1189px) and (min-width: 845px) {
    :root { --sidebar-w: var(--sidebar-w-collapsed); }
    .nav-toggle { display: none; }        /* hamburger hidden */
    #navBackdrop { display: none !important; }
  
    /* lock layout to rail width so content never jumps */
    .sidebar { width: var(--sidebar-w-collapsed); }
    .content { margin-left: var(--sidebar-w-collapsed); }
  
    /* hover/pinned overlay expands over content (doesn’t shift layout) */
    .sidebar:hover,
    body.sidebar-peek .sidebar,
    body.sidebar-peek-pinned .sidebar {
      width: var(--sidebar-w-expanded);
      box-shadow: 12px 0 24px rgba(0,0,0,0.25);
      z-index: 80;
    }
  
    /* labels hidden until hovered or pinned */
    .sidebar .label { display: none; }
    .sidebar:hover .label,
    body.sidebar-peek .sidebar .label,
    body.sidebar-peek-pinned .sidebar .label { display: inline; }
  }
  
  /* ≤844px: Drawer (hamburger), content full width, labels always visible */
  @media (max-width: 844px) {
    :root { --sidebar-w: 0px; }
    .content { margin-left: 0; }
    .nav-toggle { display: inline-grid; }
  
    .sidebar {
      position: fixed; top: 0; left: 0; bottom: 0;
      width: var(--sidebar-w-expanded);
      transform: translate3d(-100%,0,0);  /* off-canvas by default */
      transition: transform 220ms cubic-bezier(.22,.61,.36,1);
      box-shadow: 12px 0 24px rgba(0,0,0,0.25);
      z-index: 40;
    }
    body.sidebar-open .sidebar { transform: translate3d(0,0,0); }
  
    #navBackdrop {
      display: block; position: fixed; inset: 0; background: rgba(0,0,0,.4);
      z-index: 30; opacity: 0; pointer-events: none; transition: opacity 180ms ease;
    }
    body.sidebar-open #navBackdrop { opacity: 1; pointer-events: auto; }
  
    /* prevent body scroll while drawer is open */
    body.sidebar-open { overflow: hidden; }
  
    /* show labels in drawer */
    .sidebar .label { display: inline; }
  }
  
  /* performance hint */
  .sidebar { will-change: transform; }
  
  /* Give Today the same left/right gutter as Boards */
body[data-view="today"] #app {
  padding: 24px var(--boards-gutter);
}

.list .list-menu i { color: var(--pill); } 